{% extends "base.html" %}

{% block title %}é¦–é¡µ - è‚¡ç¥¨åˆ†æç³»ç»Ÿ{% endblock %}

{% block extra_css %}
<style>
    /* ç§»åŠ¨ç«¯é¦–é¡µä¼˜åŒ– */
    @media (max-width: 768px) {
        /* æ¬¢è¿æ¨ªå¹…ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .stock-info .card-body {
            padding: 2rem 1rem;
        }
        
        .stock-info .display-4 {
            font-size: 2rem;
        }
        
        .stock-info .lead {
            font-size: 1rem;
        }
        
        .stock-info p {
            font-size: 0.9rem;
        }
        
        .stock-info .btn {
            margin-bottom: 0.5rem;
            width: 100%;
        }
        
        /* åŠŸèƒ½å¡ç‰‡ç§»åŠ¨ç«¯ä¼˜åŒ– */
        .metric-card .fa-3x {
            font-size: 2rem;
        }
        
        .metric-card .card-title {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .metric-card .card-text {
            font-size: 0.85rem;
            margin-bottom: 1rem;
        }
        
        .metric-card .btn {
            font-size: 0.85rem;
            padding: 0.5rem 1rem;
        }
        
        /* æ•°æ®æ¦‚è§ˆå¡ç‰‡ä¼˜åŒ– */
        .data-overview-card h3 {
            font-size: 1.5rem;
        }
        
        .data-overview-card .card-text {
            font-size: 0.9rem;
        }
        
        /* ç³»ç»Ÿç‰¹æ€§å¡ç‰‡ä¼˜åŒ– */
        .feature-card .card-title {
            font-size: 1rem;
        }
        
        .feature-card .card-text {
            font-size: 0.85rem;
        }
        
        /* æ ‡é¢˜ä¼˜åŒ– */
        h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        /* é—´è·ä¼˜åŒ– */
        .mb-4 {
            margin-bottom: 1.5rem !important;
        }
        
        .mb-5 {
            margin-bottom: 2rem !important;
        }
    }
    
    @media (max-width: 576px) {
        .stock-info .card-body {
            padding: 1.5rem 0.75rem;
        }
        
        .stock-info .display-4 {
            font-size: 1.75rem;
        }
        
        .metric-card .fa-3x {
            font-size: 1.75rem;
        }
        
        .metric-card .card-body {
            padding: 1rem 0.75rem;
        }
        
        .data-overview-card h3 {
            font-size: 1.25rem;
        }
        
        h2 {
            font-size: 1.25rem;
        }
    }
    
    /* è§¦æ‘¸ä¼˜åŒ– */
    @media (hover: none) and (pointer: coarse) {
        .metric-card {
            transition: none;
        }
        
        .metric-card:active {
            transform: scale(0.98);
        }
        
        .btn:active {
            transform: scale(0.95);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <!-- æ¬¢è¿æ¨ªå¹… -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card stock-info-banner">
                <div class="card-body text-center py-5">
                    <h1 class="display-4 mb-3">ğŸ“ˆ è‚¡ç¥¨åˆ†æç³»ç»Ÿ</h1>
                    <p class="lead">åŸºäºPython Flaskå¼€å‘çš„ä¸“ä¸šè‚¡ç¥¨åˆ†æå¹³å°</p>
                    <p class="mb-4">æä¾›è‚¡ç¥¨åŸºæœ¬é¢åˆ†æã€æŠ€æœ¯é¢åˆ†æã€èµ„é‡‘æµå‘åˆ†æã€ç­¹ç åˆ†å¸ƒåˆ†æç­‰åŠŸèƒ½</p>
                    <div class="d-grid gap-2 d-md-block">
                        <a href="{{ url_for('main.stocks') }}" class="btn btn-light btn-lg me-md-3 btn-financial">å¼€å§‹åˆ†æ</a>
                        <a href="{{ url_for('main.screen') }}" class="btn btn-outline-light btn-lg btn-financial">é€‰è‚¡ç­›é€‰</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- åŠŸèƒ½æ¨¡å— -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4">ğŸš€ æ ¸å¿ƒåŠŸèƒ½</h2>
        </div>
    </div>

    <div class="row g-3 g-md-4 mb-5">
        <!-- è‚¡ç¥¨åˆ—è¡¨ -->
        <div class="col-6 col-md-6 col-lg-3">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-list-ul text-primary"></i>
                    </div>
                    <h5 class="card-title">è‚¡ç¥¨åˆ—è¡¨</h5>
                    <p class="card-text">æµè§ˆæ‰€æœ‰è‚¡ç¥¨ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰è¡Œä¸šã€åœ°åŸŸç­›é€‰</p>
                    <a href="{{ url_for('main.stocks') }}" class="btn btn-primary-financial">æŸ¥çœ‹è‚¡ç¥¨</a>
                </div>
            </div>
        </div>

        <!-- æŠ€æœ¯åˆ†æ -->
        <div class="col-6 col-md-6 col-lg-3">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-chart-line text-success"></i>
                    </div>
                    <h5 class="card-title">æŠ€æœ¯åˆ†æ</h5>
                    <p class="card-text">Kçº¿å›¾ã€MACDã€KDJã€RSIç­‰æŠ€æœ¯æŒ‡æ ‡åˆ†æ</p>
                    <a href="{{ url_for('main.analysis') }}" class="btn btn-success-financial">æŠ€æœ¯åˆ†æ</a>
                </div>
            </div>
        </div>

        <!-- é€‰è‚¡ç­›é€‰ -->
        <div class="col-6 col-md-6 col-lg-3">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-filter text-warning"></i>
                    </div>
                    <h5 class="card-title">é€‰è‚¡ç­›é€‰</h5>
                    <p class="card-text">å¤šç»´åº¦æ¡ä»¶ç­›é€‰ï¼Œå‘ç°æŠ•èµ„æœºä¼š</p>
                    <a href="{{ url_for('main.screen') }}" class="btn btn-warning-financial">å¼€å§‹ç­›é€‰</a>
                </div>
            </div>
        </div>

        <!-- ç­–ç•¥å›æµ‹ -->
        <div class="col-6 col-md-6 col-lg-3">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-history text-info"></i>
                    </div>
                    <h5 class="card-title">ç­–ç•¥å›æµ‹</h5>
                    <p class="card-text">éªŒè¯æŠ•èµ„ç­–ç•¥çš„å†å²è¡¨ç°</p>
                    <a href="{{ url_for('main.backtest') }}" class="btn btn-primary-financial">ç­–ç•¥å›æµ‹</a>
                </div>
            </div>
        </div>
    </div>

    <!-- å¤šå› å­æ¨¡å‹ç³»ç»Ÿ -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4">ğŸ§  å¤šå› å­æ¨¡å‹ç³»ç»Ÿ</h2>
        </div>
    </div>

    <div class="row g-3 g-md-4 mb-5">
        <!-- å› å­ç®¡ç† -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-cogs text-primary"></i>
                    </div>
                    <h5 class="card-title">å› å­ç®¡ç†</h5>
                    <p class="card-text">ç®¡ç†æŠ€æœ¯é¢ã€åŸºæœ¬é¢ã€èµ„é‡‘é¢ç­‰å„ç±»å› å­</p>
                    <a href="/ml-factor" class="btn btn-primary-financial">å› å­ç®¡ç†</a>
                </div>
            </div>
        </div>

        <!-- æ¨¡å‹ç®¡ç† -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-brain text-success"></i>
                    </div>
                    <h5 class="card-title">æ¨¡å‹ç®¡ç†</h5>
                    <p class="card-text">åˆ›å»ºå’Œè®­ç»ƒæœºå™¨å­¦ä¹ é€‰è‚¡æ¨¡å‹</p>
                    <a href="/ml-factor/models" class="btn btn-success-financial">æ¨¡å‹ç®¡ç†</a>
                </div>
            </div>
        </div>

        <!-- æ™ºèƒ½æŸ¥è¯¢ -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-robot text-info"></i>
                    </div>
                    <h5 class="card-title">æ™ºèƒ½æŸ¥è¯¢</h5>
                    <p class="card-text">ç”¨è‡ªç„¶è¯­è¨€æŸ¥è¯¢è‚¡ç¥¨æ•°æ®ï¼ŒAIåŠ©æ‰‹</p>
                    <a href="/api/text2sql/" class="btn btn-primary-financial">æ™ºèƒ½æŸ¥è¯¢</a>
                </div>
            </div>
        </div>

        <!-- è‚¡ç¥¨è¯„åˆ† -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-star text-warning"></i>
                    </div>
                    <h5 class="card-title">è‚¡ç¥¨è¯„åˆ†</h5>
                    <p class="card-text">åŸºäºå› å­å’Œæ¨¡å‹å¯¹è‚¡ç¥¨è¿›è¡Œè¯„åˆ†æ’å</p>
                    <a href="/ml-factor/scoring" class="btn btn-warning-financial">è‚¡ç¥¨è¯„åˆ†</a>
                </div>
            </div>
        </div>

        <!-- æŠ•èµ„ç»„åˆ -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-briefcase text-info"></i>
                    </div>
                    <h5 class="card-title">æŠ•èµ„ç»„åˆ</h5>
                    <p class="card-text">æ™ºèƒ½æ„å»ºå’Œä¼˜åŒ–æŠ•èµ„ç»„åˆ</p>
                    <a href="/ml-factor/portfolio" class="btn btn-primary-financial">æŠ•èµ„ç»„åˆ</a>
                </div>
            </div>
        </div>

        <!-- åˆ†ææŠ¥å‘Š -->
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-chart-bar text-secondary"></i>
                    </div>
                    <h5 class="card-title">åˆ†ææŠ¥å‘Š</h5>
                    <p class="card-text">æ¨¡å‹æ€§èƒ½åˆ†æå’Œå› å­æœ‰æ•ˆæ€§è¯„ä¼°</p>
                    <a href="/ml-factor/analysis" class="btn btn-primary-financial">åˆ†ææŠ¥å‘Š</a>
                </div>
            </div>
        </div>
    </div>

    <!-- å®æ—¶äº¤æ˜“åˆ†æç³»ç»Ÿ -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4">âš¡ å®æ—¶äº¤æ˜“åˆ†æç³»ç»Ÿ</h2>
        </div>
    </div>

    <div class="row g-3 g-md-4 mb-5">
        <!-- å®æ—¶äº¤æ˜“åˆ†æ -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-chart-line text-danger"></i>
                    </div>
                    <h5 class="card-title">å®æ—¶äº¤æ˜“åˆ†æ</h5>
                    <p class="card-text">åˆ†é’Ÿçº§æ•°æ®ç®¡ç†ã€æŠ€æœ¯æŒ‡æ ‡åˆ†æã€äº¤æ˜“ä¿¡å·ç”Ÿæˆå’Œé£é™©ç›‘æ§</p>
                    <a href="/realtime-analysis" class="btn btn-danger-financial">è¿›å…¥åˆ†æ</a>
                </div>
            </div>
        </div>

        <!-- æ•°æ®ç®¡ç† -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-database text-primary"></i>
                    </div>
                    <h5 class="card-title">å®æ—¶æ•°æ®ç®¡ç†</h5>
                    <p class="card-text">åˆ†é’Ÿçº§Kçº¿æ•°æ®åŒæ­¥ã€èšåˆå’Œè´¨é‡ç›‘æ§</p>
                    <a href="/realtime-analysis" class="btn btn-primary-financial">æ•°æ®ç®¡ç†</a>
                </div>
            </div>
        </div>

        <!-- æŠ€æœ¯æŒ‡æ ‡ -->
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card metric-card-enhanced h-100 hover-lift">
                <div class="card-body text-center">
                    <div class="metric-icon">
                        <i class="fas fa-chart-bar text-success"></i>
                    </div>
                    <h5 class="card-title">å®æ—¶æŠ€æœ¯æŒ‡æ ‡</h5>
                    <p class="card-text">å¤šå‘¨æœŸæŠ€æœ¯æŒ‡æ ‡è®¡ç®—å’Œé¢„è­¦ç³»ç»Ÿ</p>
                    <a href="/realtime-analysis/indicators" class="btn btn-success-financial">æŠ€æœ¯æŒ‡æ ‡</a>
                </div>
            </div>
        </div>
    </div>

    <!-- æ•°æ®æ¦‚è§ˆ -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4">ğŸ“Š æ•°æ®æ¦‚è§ˆ</h2>
        </div>
    </div>

    <div class="row g-3 g-md-4 mb-5">
        <div class="col-6 col-md-3">
            <div class="card card-financial text-center">
                <div class="card-body">
                    <h3 class="text-primary number-display" id="total-stocks">--</h3>
                    <p class="card-text">è‚¡ç¥¨æ€»æ•°</p>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card card-financial text-center">
                <div class="card-body">
                    <h3 class="text-success number-display" id="total-industries">--</h3>
                    <p class="card-text">è¡Œä¸šæ•°é‡</p>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card card-financial text-center">
                <div class="card-body">
                    <h3 class="text-warning number-display" id="total-areas">--</h3>
                    <p class="card-text">åœ°åŸŸæ•°é‡</p>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="card card-financial text-center">
                <div class="card-body">
                    <h3 class="text-info number-display">7</h3>
                    <p class="card-text">æ•°æ®è¡¨</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ç³»ç»Ÿç‰¹æ€§ -->
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="mb-4">âœ¨ ç³»ç»Ÿç‰¹æ€§</h2>
        </div>
    </div>

    <div class="row g-3 g-md-4">
        <div class="col-12 col-md-4">
            <div class="card card-financial h-100">
                <div class="card-body">
                    <h5 class="card-title">ğŸ”„ å®æ—¶æ•°æ®</h5>
                    <p class="card-text">æ”¯æŒæ•°æ®è‡ªåŠ¨æ›´æ–°ï¼Œç¡®ä¿åˆ†æç»“æœçš„æ—¶æ•ˆæ€§</p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card card-financial h-100">
                <div class="card-body">
                    <h5 class="card-title">ğŸ“ˆ å¤šç»´åˆ†æ</h5>
                    <p class="card-text">åŸºæœ¬é¢ã€æŠ€æœ¯é¢ã€èµ„é‡‘é¢ã€ç­¹ç é¢å…¨æ–¹ä½åˆ†æ</p>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-4">
            <div class="card card-financial h-100">
                <div class="card-body">
                    <h5 class="card-title">ğŸ¯ æ™ºèƒ½ç­›é€‰</h5>
                    <p class="card-text">å¤šæ¡ä»¶ç»„åˆç­›é€‰ï¼Œå¿«é€Ÿå‘ç°æŠ•èµ„æœºä¼š</p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// é¡µé¢åŠ è½½å®Œæˆåè·å–ç»Ÿè®¡æ•°æ®
document.addEventListener('DOMContentLoaded', async function() {
    try {
        // è·å–è‚¡ç¥¨æ€»æ•°
        const stocksResponse = await apiRequest('/stocks?page_size=1');
        if (stocksResponse.code === 200) {
            document.getElementById('total-stocks').textContent = stocksResponse.data.total;
        }

        // è·å–è¡Œä¸šæ•°é‡
        const industriesResponse = await apiRequest('/industries');
        if (industriesResponse.code === 200) {
            document.getElementById('total-industries').textContent = industriesResponse.data.length;
        }

        // è·å–åœ°åŸŸæ•°é‡
        const areasResponse = await apiRequest('/areas');
        if (areasResponse.code === 200) {
            document.getElementById('total-areas').textContent = areasResponse.data.length;
        }
    } catch (error) {
        console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
        // ç§»åŠ¨ç«¯å‹å¥½çš„é”™è¯¯æç¤º
        if (typeof MobileUtils !== 'undefined') {
            MobileUtils.showMobileToast('æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•', 'error');
        }
    }
});
</script>
{% endblock %} 